<form
  #forgotForm="ngForm"
  (ngSubmit)="onForgotPassword(forgotForm)"
  class="flex flex-col max-w-[550px] mx-auto m-4 mt-[12rem] justify-center login-container fade-in"
>
  <div
    class="flex flex-col justify-center items-center border border-gray-300 p-8 rounded-lg space-y-6 shadow-md"
  >
    <h1 class="text-2xl text-center font-bold mb-6">Recuperar Senha</h1>
    <div class="w-full flex flex-col space-y-2">
      <input
        name="email"
        [(ngModel)]="forgotUser.email"
        class="text-gray-500 w-full px-4 py-3 border border-gray-300 rounded-lg outline-none focus:outline-none focus:ring-2 focus:ring-black transition duration-200"
        [ngClass]="{
          'border-red-600 focus:ring-red-600':
            emailRef.invalid && (emailRef.dirty || emailRef.touched)
        }"
        placeholder="Email"
        required
        type="email"
        #emailRef="ngModel"
      />

      <div
        *ngIf="emailRef.invalid && (emailRef.dirty || emailRef.touched)"
        class="text-red-600 text-sm"
      >
        <span *ngIf="emailRef.errors?.['required']">Email é obrigatório.</span>
      </div>
    </div>
    <div class="w-full flex flex-col space-y-2">
      <label for="password" class="sr-only">Senha</label>
      <div class="relative">
        <input
          id="password"
          name="password"
          [(ngModel)]="forgotUser.newPassword"
          class="text-gray-500 w-full px-4 py-3 border border-gray-300 rounded-lg outline-none focus:outline-none focus:ring-2 focus:ring-black transition duration-200"
          [ngClass]="{
            'border-red-600 focus:ring-red-600':
              passwordRef.invalid && (passwordRef.dirty || passwordRef.touched)
          }"
          placeholder="Senha"
          required
          type="{{ isPasswordVisible ? 'text' : 'password' }}"
          minlength="6"
          #passwordRef="ngModel"
          autocomplete="off"
          aria-label="Senha"
          [attr.aria-describedby]="
            passwordRef.invalid && (passwordRef.dirty || passwordRef.touched)
              ? 'password-error'
              : null
          "
        />
        <mat-icon
          class="absolute top-3.5 right-5"
          (click)="togglePasswordVisibility()"
          aria-hidden="true"
        >
          {{ isPasswordVisible ? "visibility_off" : "visibility" }}
        </mat-icon>
      </div>
      <div
        *ngIf="
          passwordRef.invalid && (passwordRef.dirty || passwordRef.touched)
        "
        class="text-red-600 text-sm"
        id="password-error"
      >
        <span *ngIf="passwordRef.errors?.['required']">
          Senha é obrigatória.
        </span>
        <span *ngIf="passwordRef.errors?.['minlength']"
          >Senha deve ter no mínimo 6 caracteres.
        </span>
      </div>
    </div>
    <div class="w-full flex flex-col space-y-2">
      <label for="password" class="sr-only">Senha</label>
      <div class="relative">
        <input
          id="password"
          name="confirmPassword"
          [(ngModel)]="forgotUser.confirmPassword"
          class="text-gray-500 w-full px-4 py-3 border border-gray-300 rounded-lg outline-none focus:outline-none focus:ring-2 focus:ring-black transition duration-200"
          [ngClass]="{
            'border-red-600 focus:ring-red-600':
              confirmPasswordRef.invalid &&
              (confirmPasswordRef.dirty || confirmPasswordRef.touched)
          }"
          placeholder="Senha"
          type="{{ isConfirmPasswordVisible ? 'text' : 'password' }}"
          required
          minlength="6"
          #confirmPasswordRef="ngModel"
          autocomplete="off"
          aria-label="Senha"
          [attr.aria-describedby]="
            confirmPasswordRef.invalid &&
            (confirmPasswordRef.dirty || confirmPasswordRef.touched)
              ? 'password-error'
              : null
          "
        />
        <mat-icon
          class="absolute top-3.5 right-5"
          (click)="toggleConfirmPasswordVisibility()"
          aria-hidden="true"
        >
          {{ isConfirmPasswordVisible ? "visibility_off" : "visibility" }}
        </mat-icon>
      </div>
      <div
        *ngIf="
          confirmPasswordRef.invalid &&
          (confirmPasswordRef.dirty || confirmPasswordRef.touched)
        "
        class="text-red-600 text-sm"
        id="password-error"
      >
        <span *ngIf="confirmPasswordRef.errors?.['required']">
          Senha é obrigatória.
        </span>
        <span *ngIf="confirmPasswordRef.errors?.['minlength']"
          >Senha deve ter no mínimo 6 caracteres.
        </span>
      </div>
    </div>

    <app-submit-button [loading]="loading"></app-submit-button>

    <div class="w-full flex flex-col items-center justify-center text-sm gap-2">
      <p class="text-base text-gray-500">
        Possui uma conta?
        <a
          routerLink="/login"
          class="text-blue-500 cursor-pointer hover:underline"
          >Entre na sua conta</a
        >
      </p>
    </div>
  </div>
</form>
