<form
  #forgotForm="ngForm"
  (ngSubmit)="onForgotPassword(forgotForm)"
  class="flex flex-col max-w-[550px] mx-auto m-4 mt-[12rem] justify-center login-container fade-in"
>
  <div
    class="flex flex-col justify-center items-center border border-gray-300 p-8 rounded-lg space-y-6 shadow-md"
  >
    <h1 class="text-2xl text-center font-bold mb-6">Recuperar Senha</h1>

    <div class="w-full flex flex-col space-y-2 fade-in">
      <input
        name="email"
        [(ngModel)]="forgotUser.email"
        class="text-gray-500 w-full px-4 py-3 border border-gray-300 rounded-lg outline-none focus:outline-none focus:ring-2 focus:ring-black transition duration-200"
        [ngClass]="{
          'border-red-600 focus:ring-red-600':
            emailRef.invalid && (emailRef.dirty || emailRef.touched)
        }"
        placeholder="Email"
        required
        type="email"
        #emailRef="ngModel"
      />

      <div
        *ngIf="emailRef.invalid && (emailRef.dirty || emailRef.touched)"
        class="text-red-600 text-sm"
      >
        <span *ngIf="emailRef.errors?.['required']">E-mail é obrigatório.</span>
      </div>
    </div>
    <div
      class="w-full flex flex-col space-y-2 fade-in"
      *ngIf="!isResetFormVisible"
    >
      <input
        name="accessCode"
        [(ngModel)]="forgotUser.accessCode"
        class="text-gray-500 w-full px-4 py-3 border border-gray-300 rounded-lg outline-none focus:outline-none focus:ring-2 focus:ring-black transition duration-200"
        [ngClass]="{
          'border-red-600 focus:ring-red-600':
            accessRef.invalid && (accessRef.dirty || accessRef.touched)
        }"
        placeholder="Código de acesso"
        required
        type="text"
        #accessRef="ngModel"
      />

      <div
        *ngIf="accessRef.invalid && (accessRef.dirty || accessRef.touched)"
        class="text-red-600 text-sm"
      >
        <span *ngIf="accessRef.errors?.['required']"
          >Código de acesso é obrigatório.</span
        >
      </div>
    </div>

    <div
      class="w-full flex flex-col space-y-6 fade-in"
      *ngIf="!isResetFormVisible"
    >
      <div class="w-full flex flex-col space-y-2">
        <label for="newPassword" class="sr-only">Confirmar Senha</label>
        <div class="relative">
          <input
            id="newPassword"
            name="newPassword"
            [(ngModel)]="forgotUser.newPassword"
            class="text-gray-500 w-full px-4 py-3 border border-gray-300 rounded-lg outline-none focus:outline-none focus:ring-2 focus:ring-black transition duration-200"
            [ngClass]="{
              'border-red-600 focus:ring-red-600':
                newPasswordRef.invalid &&
                (newPasswordRef.dirty || newPasswordRef.touched)
            }"
            placeholder="Confirmar Senha"
            type="{{ isPasswordVisible ? 'text' : 'password' }}"
            required
            minlength="6"
            #newPasswordRef="ngModel"
            autocomplete="off"
          />
          <mat-icon
            class="absolute top-3.5 right-5 cursor-pointer"
            (click)="togglePasswordVisibility()"
            aria-hidden="true"
          >
            {{ isPasswordVisible ? "visibility_off" : "visibility" }}
          </mat-icon>
        </div>
        <div
          *ngIf="
            newPasswordRef.invalid &&
            (newPasswordRef.dirty || newPasswordRef.touched)
          "
          class="text-red-600 text-sm"
        >
          <span *ngIf="newPasswordRef.errors?.['required']"
            >A senha é obrigatória.</span
          >
          <span *ngIf="newPasswordRef.errors?.['minlength']"
            >A senha deve ter no mínimo 6 caracteres.</span
          >
        </div>
      </div>

      <div class="w-full flex flex-col space-y-2">
        <label for="confirmPassword" class="sr-only">Confirmar Senha</label>
        <div class="relative">
          <input
            id="confirmPassword"
            name="confirmPassword"
            [(ngModel)]="forgotUser.confirmPassword"
            class="text-gray-500 w-full px-4 py-3 border border-gray-300 rounded-lg outline-none focus:outline-none focus:ring-2 focus:ring-black transition duration-200"
            [ngClass]="{
              'border-red-600 focus:ring-red-600':
                confirmPasswordRef.invalid &&
                (confirmPasswordRef.dirty || confirmPasswordRef.touched)
            }"
            placeholder="Confirmar Senha"
            type="{{ isConfirmPasswordVisible ? 'text' : 'password' }}"
            required
            minlength="6"
            #confirmPasswordRef="ngModel"
            autocomplete="off"
          />
          <mat-icon
            class="absolute top-3.5 right-5 cursor-pointer"
            (click)="toggleConfirmPasswordVisibility()"
            aria-hidden="true"
          >
            {{ isConfirmPasswordVisible ? "visibility_off" : "visibility" }}
          </mat-icon>
        </div>
        <div
          *ngIf="
            confirmPasswordRef.invalid &&
            (confirmPasswordRef.dirty || confirmPasswordRef.touched)
          "
          class="text-red-600 text-sm"
        >
          <span *ngIf="confirmPasswordRef.errors?.['required']"
            >A confirmação de senha é obrigatória.</span
          >
          <span *ngIf="confirmPasswordRef.errors?.['minlength']"
            >A confirmação de senha deve ter no mínimo 6 caracteres.</span
          >
        </div>
      </div>

      <!-- <app-submit-button [loading]="loading"></app-submit-button> -->
    </div>
    <app-submit-button
      [loading]="loading"
      [textBtn]="
        isResetFormVisible ? 'Enviar código de acesso' : 'Redefinir senha'
      "
    >
      <!-- (click) = "isResetFormVisible ? getAccessCode : resetPassword()"  -->
    </app-submit-button>
    <!-- <span (click)="toggleForm()">Trocar</span> -->

    <div class="w-full flex flex-col items-center justify-center text-sm gap-2">
      <p class="text-base text-gray-500">
        Possui uma conta?
        <a
          routerLink="/login"
          class="text-blue-500 cursor-pointer hover:underline"
          >Entre na sua conta</a
        >
      </p>
    </div>
  </div>
</form>
